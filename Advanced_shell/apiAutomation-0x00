#!/bin/bash

# File paths
OUTPUT_FILE="data.json"
ERROR_FILE="errors.txt"

# API URL for Pikachu
API_URL="https://pokeapi.co/api/v2/pokemon/pikachu"

# Make API request
HTTP_RESPONSE=$(curl -s -w "%{http_code}" -o "$OUTPUT_FILE" "$API_URL")
HTTP_STATUS="${HTTP_RESPONSE: -3}"  # Last 3 characters are the HTTP status code

# Check if request was successful (HTTP 200)
if [ "$HTTP_STATUS" -eq 200 ]; then
    echo "API request successful. Data saved to $OUTPUT_FILE."
else
    echo "$(date '+%Y-%m-%d %H:%M:%S') - API request failed with status $HTTP_STATUS" >> "$ERROR_FILE"
    echo "Error logged to $ERROR_FILE."
    # Remove potentially incomplete output file
    [ -f "$OUTPUT_FILE" ] && rm "$OUTPUT_FILE"
fi
